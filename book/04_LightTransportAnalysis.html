
<!DOCTYPE html>

<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="generator" content="Docutils 0.17.1: http://docutils.sourceforge.net/" />

    <title>Light Transport Analysis &#8212; Computational Imaging - Course Notes</title>
    
  <!-- Loaded before other Sphinx assets -->
  <link href="_static/styles/theme.css?digest=1999514e3f237ded88cf" rel="stylesheet">
<link href="_static/styles/pydata-sphinx-theme.css?digest=1999514e3f237ded88cf" rel="stylesheet">

    
  <link rel="stylesheet"
    href="_static/vendor/fontawesome/5.13.0/css/all.min.css">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="_static/vendor/fontawesome/5.13.0/webfonts/fa-solid-900.woff2">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="_static/vendor/fontawesome/5.13.0/webfonts/fa-brands-400.woff2">

    <link rel="stylesheet" type="text/css" href="_static/pygments.css" />
    <link rel="stylesheet" href="_static/styles/sphinx-book-theme.css?digest=5115cc725059bd94278eecd172e13a965bf8f5a9" type="text/css" />
    <link rel="stylesheet" type="text/css" href="_static/togglebutton.css" />
    <link rel="stylesheet" type="text/css" href="_static/copybutton.css" />
    <link rel="stylesheet" type="text/css" href="_static/mystnb.css" />
    <link rel="stylesheet" type="text/css" href="_static/sphinx-thebe.css" />
    <link rel="stylesheet" type="text/css" href="_static/design-style.b7bb847fb20b106c3d81b95245e65545.min.css" />
    
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="_static/scripts/pydata-sphinx-theme.js?digest=1999514e3f237ded88cf">

    <script data-url_root="./" id="documentation_options" src="_static/documentation_options.js"></script>
    <script src="_static/jquery.js"></script>
    <script src="_static/underscore.js"></script>
    <script src="_static/doctools.js"></script>
    <script src="_static/clipboard.min.js"></script>
    <script src="_static/copybutton.js"></script>
    <script src="_static/scripts/sphinx-book-theme.js?digest=9c920249402e914e316237a7dbc6769907cce411"></script>
    <script>let toggleHintShow = 'Click to show';</script>
    <script>let toggleHintHide = 'Click to hide';</script>
    <script>let toggleOpenOnPrint = 'true';</script>
    <script src="_static/togglebutton.js"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown, .tag_hide_input div.cell_input, .tag_hide-input div.cell_input, .tag_hide_output div.cell_output, .tag_hide-output div.cell_output, .tag_hide_cell.cell, .tag_hide-cell.cell';</script>
    <script src="_static/design-tabs.js"></script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"
const thebe_selector = ".thebe,.cell"
const thebe_selector_input = "pre"
const thebe_selector_output = ".output, .cell_output"
</script>
    <script async="async" src="_static/sphinx-thebe.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
    <script src="https://unpkg.com/@jupyter-widgets/html-manager@^0.20.0/dist/embed-amd.js"></script>
    <script>window.MathJax = {"options": {"processHtmlClass": "tex2jax_process|mathjax_process|math|output_area"}}</script>
    <script defer="defer" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="Neural Networks for Computational Imaging" href="05_NeuralNetworksForCompImg.html" />
    <link rel="prev" title="Light Field Methods" href="03_LightFieldMethods.html" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <meta name="docsearch:language" content="None">
    

    <!-- Google Analytics -->
    
  </head>
  <body data-spy="scroll" data-target="#bd-toc-nav" data-offset="60">
<!-- Checkboxes to toggle the left sidebar -->
<input type="checkbox" class="sidebar-toggle" name="__navigation" id="__navigation" aria-label="Toggle navigation sidebar">
<label class="overlay overlay-navbar" for="__navigation">
    <div class="visually-hidden">Toggle navigation sidebar</div>
</label>
<!-- Checkboxes to toggle the in-page toc -->
<input type="checkbox" class="sidebar-toggle" name="__page-toc" id="__page-toc" aria-label="Toggle in-page Table of Contents">
<label class="overlay overlay-pagetoc" for="__page-toc">
    <div class="visually-hidden">Toggle in-page Table of Contents</div>
</label>
<!-- Headers at the top -->
<div class="announcement header-item noprint"></div>
<div class="header header-item noprint"></div>

    
    <div class="container-fluid" id="banner"></div>

    

    <div class="container-xl">
      <div class="row">
          
<!-- Sidebar -->
<div class="bd-sidebar noprint" id="site-navigation">
    <div class="bd-sidebar__content">
        <div class="bd-sidebar__top"><div class="navbar-brand-box">
    <a class="navbar-brand text-wrap" href="index.html">
      
      
      
      <h1 class="site-logo" id="site-title">Computational Imaging - Course Notes</h1>
      
    </a>
</div><form class="bd-search d-flex align-items-center" action="search.html" method="get">
  <i class="icon fas fa-search"></i>
  <input type="search" class="form-control" name="q" id="search-input" placeholder="Search this book..." aria-label="Search this book..." autocomplete="off" >
</form><nav class="bd-links" id="bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item active">
        
        <ul class="nav bd-sidenav bd-sidenav__home-link">
            <li class="toctree-l1">
                <a class="reference internal" href="intro.html">
                    Computational Imaging - Course Notes for Winter Term 2022 / 2023
                </a>
            </li>
        </ul>
        <ul class="current nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="01_Introduction.html">
   Introduction
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="02_Basics.html">
   Fundamental Basics
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="03_LightFieldMethods.html">
   Light Field Methods
  </a>
 </li>
 <li class="toctree-l1 current active">
  <a class="current reference internal" href="#">
   Light Transport Analysis
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="05_NeuralNetworksForCompImg.html">
   Neural Networks for Computational Imaging
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="06_InverseProblemsInCompimg.html">
   Inverse Problems in Computational Imaging
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="07_LenslessImaging.html">
   Lensless Imaging
  </a>
 </li>
</ul>

    </div>
</nav></div>
        <div class="bd-sidebar__bottom">
             <!-- To handle the deprecated key -->
            
            <div class="navbar_extra_footer">
            Powered by <a href="https://jupyterbook.org">Jupyter Book</a>
            </div>
            
        </div>
    </div>
    <div id="rtd-footer-container"></div>
</div>


          


          
<!-- A tiny helper pixel to detect if we've scrolled -->
<div class="sbt-scroll-pixel-helper"></div>
<!-- Main content -->
<div class="col py-0 content-container">
    
    <div class="header-article row sticky-top noprint">
        



<div class="col py-1 d-flex header-article-main">
    <div class="header-article__left">
        
        <label for="__navigation"
  class="headerbtn"
  data-toggle="tooltip"
data-placement="right"
title="Toggle navigation"
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-bars"></i>
  </span>

</label>

        
    </div>
    <div class="header-article__right">
<div class="menu-dropdown menu-dropdown-launch-buttons">
  <button class="headerbtn menu-dropdown__trigger"
      aria-label="Launch interactive content">
      <i class="fas fa-rocket"></i>
  </button>
  <div class="menu-dropdown__content">
    <ul>
    </ul>
  </div>
</div>

<button onclick="toggleFullScreen()"
  class="headerbtn"
  data-toggle="tooltip"
data-placement="bottom"
title="Fullscreen mode"
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-expand"></i>
  </span>

</button>

<div class="menu-dropdown menu-dropdown-download-buttons">
  <button class="headerbtn menu-dropdown__trigger"
      aria-label="Download this page">
      <i class="fas fa-download"></i>
  </button>
  <div class="menu-dropdown__content">
    <ul>
      <li>
        <a href="_sources/04_LightTransportAnalysis.ipynb"
   class="headerbtn"
   data-toggle="tooltip"
data-placement="left"
title="Download notebook file"
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-code"></i>
  </span>
<span class="headerbtn__text-container">.ipynb</span>
</a>

      </li>
      
      <li>
        <a href="_sources/04_LightTransportAnalysis.md"
   class="headerbtn"
   data-toggle="tooltip"
data-placement="left"
title="Download source file"
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-file"></i>
  </span>
<span class="headerbtn__text-container">.md</span>
</a>

      </li>
      
      <li>
        
<button onclick="printPdf(this)"
  class="headerbtn"
  data-toggle="tooltip"
data-placement="left"
title="Print to PDF"
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-file-pdf"></i>
  </span>
<span class="headerbtn__text-container">.pdf</span>
</button>

      </li>
      
    </ul>
  </div>
</div>
<label for="__page-toc"
  class="headerbtn headerbtn-page-toc"
  
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-list"></i>
  </span>

</label>

    </div>
</div>

<!-- Table of contents -->
<div class="col-md-3 bd-toc show noprint">
    <div class="tocsection onthispage pt-5 pb-3">
        <i class="fas fa-list"></i> Contents
    </div>
    <nav id="bd-toc-nav" aria-label="Page">
        <ul class="visible nav section-nav flex-column">
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#content">
   Content
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#introduction-into-light-transport">
   Introduction into light transport
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#example">
     Example
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#id1">
     Example
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#practical-limitations">
     Practical limitations
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#optical-linear-algebra">
     Optical linear algebra
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#light-paths">
     Light paths
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#teaser">
     Teaser
    </a>
    <ul class="nav section-nav flex-column">
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#id2">
       Example
      </a>
     </li>
    </ul>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#entries-of-the-light-transport-matrix">
     Entries of the light transport matrix
    </a>
    <ul class="nav section-nav flex-column">
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#helmholtz-reciprocity-principle">
       Helmholtz reciprocity principle
      </a>
     </li>
    </ul>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#light-transport-analysis-via-optical-computing">
   Light transport analysis via optical computing
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#optical-power-iteration">
     Optical power iteration
    </a>
    <ul class="nav section-nav flex-column">
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#power-iteration">
       Power iteration
      </a>
     </li>
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#implementation">
       Implementation
      </a>
     </li>
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#limitations">
       Limitations
      </a>
     </li>
    </ul>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#krylov-subspace-methods">
     Krylov subspace methods
    </a>
    <ul class="nav section-nav flex-column">
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#optical-matrix-vector-multiplication-for-arbitrary-vectors">
       Optical matrix-vector multiplication for arbitrary vectors
      </a>
     </li>
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#symmetry-of-transport-matrix">
       Symmetry of transport matrix
      </a>
      <ul class="nav section-nav flex-column">
       <li class="toc-h5 nav-item toc-entry">
        <a class="reference internal nav-link" href="#enforcing-symmetry-for-mathbf-t">
         Enforcing symmetry for
         <span class="math notranslate nohighlight">
          \(\mathbf{T}\)
         </span>
        </a>
       </li>
      </ul>
     </li>
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#low-rank-approximation-of-mathbf-t-via-optical-arnoldi">
       Low-rank approximation of
       <span class="math notranslate nohighlight">
        \(\mathbf{T}\)
       </span>
       via optical Arnoldi
      </a>
     </li>
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#optical-matrix-inversion-via-gmres">
       Optical matrix inversion via GMRES
      </a>
      <ul class="nav section-nav flex-column">
       <li class="toc-h5 nav-item toc-entry">
        <a class="reference internal nav-link" href="#example-experiments">
         Example experiments
        </a>
       </li>
      </ul>
     </li>
    </ul>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#primal-dual-coding-for-optical-probing">
   Primal-Dual coding for optical probing
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#probing-the-light-transport-matrix">
     Probing the light transport matrix
    </a>
    <ul class="nav section-nav flex-column">
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#example-probing-matrices">
       Example probing matrices
      </a>
      <ul class="nav section-nav flex-column">
       <li class="toc-h5 nav-item toc-entry">
        <a class="reference internal nav-link" href="#how-to-perform-the-probing">
         How to perform the probing?
        </a>
       </li>
      </ul>
     </li>
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#optical-implementation-of-matrix-probing">
       Optical implementation of matrix probing
      </a>
     </li>
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#enhancing-the-direct-component">
       Enhancing the direct component
      </a>
     </li>
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#attenuation-of-local-scattering">
       Attenuation of local scattering
      </a>
      <ul class="nav section-nav flex-column">
       <li class="toc-h5 nav-item toc-entry">
        <a class="reference internal nav-link" href="#id3">
         Example
        </a>
       </li>
      </ul>
     </li>
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#only-indirect-light-transport">
       Only indirect light transport
      </a>
     </li>
    </ul>
   </li>
  </ul>
 </li>
</ul>

    </nav>
</div>
    </div>
    <div class="article row">
        <div class="col pl-md-3 pl-lg-5 content-container">
            <!-- Table of contents that is only displayed when printing the page -->
            <div id="jb-print-docs-body" class="onlyprint">
                <h1>Light Transport Analysis</h1>
                <!-- Table of contents -->
                <div id="print-main-content">
                    <div id="jb-print-toc">
                        
                        <div>
                            <h2> Contents </h2>
                        </div>
                        <nav aria-label="Page">
                            <ul class="visible nav section-nav flex-column">
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#content">
   Content
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#introduction-into-light-transport">
   Introduction into light transport
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#example">
     Example
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#id1">
     Example
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#practical-limitations">
     Practical limitations
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#optical-linear-algebra">
     Optical linear algebra
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#light-paths">
     Light paths
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#teaser">
     Teaser
    </a>
    <ul class="nav section-nav flex-column">
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#id2">
       Example
      </a>
     </li>
    </ul>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#entries-of-the-light-transport-matrix">
     Entries of the light transport matrix
    </a>
    <ul class="nav section-nav flex-column">
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#helmholtz-reciprocity-principle">
       Helmholtz reciprocity principle
      </a>
     </li>
    </ul>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#light-transport-analysis-via-optical-computing">
   Light transport analysis via optical computing
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#optical-power-iteration">
     Optical power iteration
    </a>
    <ul class="nav section-nav flex-column">
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#power-iteration">
       Power iteration
      </a>
     </li>
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#implementation">
       Implementation
      </a>
     </li>
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#limitations">
       Limitations
      </a>
     </li>
    </ul>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#krylov-subspace-methods">
     Krylov subspace methods
    </a>
    <ul class="nav section-nav flex-column">
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#optical-matrix-vector-multiplication-for-arbitrary-vectors">
       Optical matrix-vector multiplication for arbitrary vectors
      </a>
     </li>
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#symmetry-of-transport-matrix">
       Symmetry of transport matrix
      </a>
      <ul class="nav section-nav flex-column">
       <li class="toc-h5 nav-item toc-entry">
        <a class="reference internal nav-link" href="#enforcing-symmetry-for-mathbf-t">
         Enforcing symmetry for
         <span class="math notranslate nohighlight">
          \(\mathbf{T}\)
         </span>
        </a>
       </li>
      </ul>
     </li>
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#low-rank-approximation-of-mathbf-t-via-optical-arnoldi">
       Low-rank approximation of
       <span class="math notranslate nohighlight">
        \(\mathbf{T}\)
       </span>
       via optical Arnoldi
      </a>
     </li>
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#optical-matrix-inversion-via-gmres">
       Optical matrix inversion via GMRES
      </a>
      <ul class="nav section-nav flex-column">
       <li class="toc-h5 nav-item toc-entry">
        <a class="reference internal nav-link" href="#example-experiments">
         Example experiments
        </a>
       </li>
      </ul>
     </li>
    </ul>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#primal-dual-coding-for-optical-probing">
   Primal-Dual coding for optical probing
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#probing-the-light-transport-matrix">
     Probing the light transport matrix
    </a>
    <ul class="nav section-nav flex-column">
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#example-probing-matrices">
       Example probing matrices
      </a>
      <ul class="nav section-nav flex-column">
       <li class="toc-h5 nav-item toc-entry">
        <a class="reference internal nav-link" href="#how-to-perform-the-probing">
         How to perform the probing?
        </a>
       </li>
      </ul>
     </li>
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#optical-implementation-of-matrix-probing">
       Optical implementation of matrix probing
      </a>
     </li>
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#enhancing-the-direct-component">
       Enhancing the direct component
      </a>
     </li>
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#attenuation-of-local-scattering">
       Attenuation of local scattering
      </a>
      <ul class="nav section-nav flex-column">
       <li class="toc-h5 nav-item toc-entry">
        <a class="reference internal nav-link" href="#id3">
         Example
        </a>
       </li>
      </ul>
     </li>
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#only-indirect-light-transport">
       Only indirect light transport
      </a>
     </li>
    </ul>
   </li>
  </ul>
 </li>
</ul>

                        </nav>
                    </div>
                </div>
            </div>
            <main id="main-content" role="main">
                
              <div>
                
  <div class="cell tag_remove-input tag_book_only docutils container">
</div>
<p><span class="math notranslate nohighlight">\(\begin{align}
  \newcommand{transp}{^\intercal}
  \newcommand{F}{\mathcal{F}}
  \newcommand{Fi}{\mathcal{F}^{-1}}
  \newcommand{inv}{^{-1}}
  \newcommand{stochvec}[1]{\mathbf{\tilde{#1}}}
  \newcommand{argmax}[1]{\underset{#1}{\mathrm{arg\, max}}}
  \newcommand{argmin}[1]{\underset{#1}{\mathrm{arg\, min}}}
\end{align}\)</span></p>
<p><font size="7"> Computational Imaging </font><br><br><br></p>
<section class="tex2jax_ignore mathjax_ignore" id="light-transport-analysis">
<h1>Light Transport Analysis<a class="headerlink" href="#light-transport-analysis" title="Permalink to this headline">#</a></h1>
<section id="content">
<h2>Content<a class="headerlink" href="#content" title="Permalink to this headline">#</a></h2>
<ul class="simple">
<li><p>Introduction into light transport</p></li>
<li><p>Light transport analysis via optical computing</p></li>
<li><p>Primal-Dual coding for optical probing</p></li>
</ul>
</section>
<section id="introduction-into-light-transport">
<h2>Introduction into light transport<a class="headerlink" href="#introduction-into-light-transport" title="Permalink to this headline">#</a></h2>
<ul class="simple">
<li><p>Light transport = all light travelling in a scene from illumination sources to sensor elements (i.e., pixels).</p></li>
<li><p>Can be mathematically described via the so-called <em>light transport matrix</em> <span class="math notranslate nohighlight">\(\mathbf{T}\)</span>, if the common assumption of linear light transport is made.</p></li>
</ul>
<p>The matrix <span class="math notranslate nohighlight">\(\mathbf{T}\)</span> contains the individual influences of all <span class="math notranslate nohighlight">\(P\)</span> light sources to all <span class="math notranslate nohighlight">\(I\)</span> sensor elements and hence has dimensions of <span class="math notranslate nohighlight">\(\mathbf{T} \in \mathbb{R}^{I\times P}_+\)</span>.</p>
<p>The elements of <span class="math notranslate nohighlight">\(\mathbf{T}\)</span> are non-negative as only positive energy or no energy can be transported via light.</p>
<p>The <em>light transport equation</em></p>
<p><span class="math notranslate nohighlight">\(\begin{align} 
   \mathbf{i} = \mathbf{T}\mathbf{p}
\end{align}\)</span></p>
<p>describes the formation of the sensor values <span class="math notranslate nohighlight">\(\mathbf{i}\)</span> of the <span class="math notranslate nohighlight">\(I\)</span> sensor elements when the scene is illuminated by the <span class="math notranslate nohighlight">\(P\)</span> light sources with respective intensities <span class="math notranslate nohighlight">\(\mathbf{p}\)</span>.</p>
<p>For the following content, we will assume illumination of the scene by a projector projecting a two-dimensional image and a two-dimensional gray-value camera serving as the sensor.</p>
<p>In this case, <span class="math notranslate nohighlight">\(\mathbf{i}\)</span> and <span class="math notranslate nohighlight">\(\mathbf{p}\)</span> are the vector representations of the camera image, respectively, of the projected image or pattern.</p>
<p>If the light transport matrix <span class="math notranslate nohighlight">\(\mathbf{T}\)</span> is known, the camera image that would result from the illumination with an arbitrary pattern <span class="math notranslate nohighlight">\(\mathbf{p}\)</span> could be synthetically calculated by just evaluating the light transport equation</p>
<p><span class="math notranslate nohighlight">\(\begin{align} 
  \mathbf{i} = \mathbf{T}\mathbf{p} \,.
\end{align}\)</span></p>
<section id="example">
<h3>Example<a class="headerlink" href="#example" title="Permalink to this headline">#</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">interact</span><span class="p">(</span><span class="k">lambda</span> <span class="n">i</span><span class="p">:</span> <span class="n">showFig</span><span class="p">(</span><span class="s1">&#39;figures/4/desk_lightsources_example_&#39;</span><span class="p">,</span><span class="n">i</span><span class="p">,</span><span class="s1">&#39;.svg&#39;</span><span class="p">,</span><span class="mi">800</span><span class="p">,</span><span class="mi">50</span><span class="p">),</span> <span class="n">i</span><span class="o">=</span><span class="n">widgets</span><span class="o">.</span><span class="n">IntSlider</span><span class="p">(</span><span class="nb">min</span><span class="o">=</span><span class="p">(</span><span class="n">min_i</span><span class="o">:=</span><span class="mi">1</span><span class="p">),</span><span class="nb">max</span><span class="o">=</span><span class="p">(</span><span class="n">max_i</span><span class="o">:=</span><span class="mi">5</span><span class="p">),</span> <span class="n">step</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">value</span><span class="o">=</span><span class="p">(</span><span class="n">max_i</span> <span class="k">if</span> <span class="n">book</span> <span class="k">else</span> <span class="n">min_i</span><span class="p">)))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<script type="application/vnd.jupyter.widget-view+json">
{"version_major": 2, "version_minor": 0, "model_id": "548eca9b5c6a483ba3a0e5c0530b13e2"}
</script><div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&lt;function __main__.&lt;lambda&gt;(i)&gt;
</pre></div>
</div>
</div>
</div>
<p>(All images in this chapter are kindly provided by Matthew O’Toole).</p>
<p>In this sense, the element <span class="math notranslate nohighlight">\(T[m,n]\)</span> of <span class="math notranslate nohighlight">\(\mathbf{T}\)</span> encodes the contribution of light source (i.e., projector pixel) <span class="math notranslate nohighlight">\(n\)</span> to camera pixel <span class="math notranslate nohighlight">\(m\)</span>.</p>
<p>Unfortunately, the matrix <span class="math notranslate nohighlight">\(\mathbf{T}\)</span> is too large to measure and handle digitally for many practically relevant applications.</p>
</section>
<section id="id1">
<h3>Example<a class="headerlink" href="#id1" title="Permalink to this headline">#</a></h3>
<p>Example light transport matrix for a single row (highlighted in (a)) of image and projector pixels. Further highlighted are the image position corresponding to camera pixel <span class="math notranslate nohighlight">\(m\)</span> and the position corresponding to projector pixel <span class="math notranslate nohighlight">\(n\)</span>:<br>
<img src="figures/4/example_transport_matrix.svg" style="max-width:30vw"></p>
</section>
<section id="practical-limitations">
<h3>Practical limitations<a class="headerlink" href="#practical-limitations" title="Permalink to this headline">#</a></h3>
<p>Consider a pair of a camera and a projector both having a (comparatively low) resolution of 1 mega pixels, then the resulting light transport matrix would have <span class="math notranslate nohighlight">\(10^{12}\)</span> elements.</p>
<ul class="simple">
<li><p>With an acquisition rate of <span class="math notranslate nohighlight">\(30\)</span> Hz, acquiring the required <span class="math notranslate nohighlight">\(10^6\)</span> measurements would need over 9 hours of time.</p></li>
<li><p>For a quantization of 8 bit per pixel for the camera images, <span class="math notranslate nohighlight">\(\mathbf{T}\)</span> would require about one terabyte of storage.</p></li>
</ul>
</section>
<section id="optical-linear-algebra">
<h3>Optical linear algebra<a class="headerlink" href="#optical-linear-algebra" title="Permalink to this headline">#</a></h3>
<p>To overcome the mentioned limitations, we will study approaches to perform linear algebra calculations involving <span class="math notranslate nohighlight">\(\mathbf{T}\)</span> only in the optical domain, i.e., without ever capturing the single elements of <span class="math notranslate nohighlight">\(\mathbf{T}\)</span>.</p>
</section>
<section id="light-paths">
<h3>Light paths<a class="headerlink" href="#light-paths" title="Permalink to this headline">#</a></h3>
<p>We again assume that all geometric structures involved in our imaging system are significantly larger than the wavelength of the employed light, so that the model of geometric optics, i.e., of light propagating along rays, is valid.</p>
<p>While travelling through the scene, light rays can be refracted, reflected, scattered, etc. until they either hit one of the camera’s pixels or get absorbed or exit the scene.</p>
<p>We denote a sequence of such light rays which connect a light source (i.e., a projector pixel) and a camera pixel as a <em>light path</em>.</p>
<p>Light paths can be categorized into <em>direct</em> and <em>indirect</em> paths.</p>
<img src="figures/4/light_path_categories.png" style="max-width:30vw"><ul class="simple">
<li><p><strong>Black ray - direct paths</strong>: From projector pixel to camera pixel via single scene point interaction.</p></li>
<li><p><strong>Indirect paths</strong>: Interaction with multiple scene points:</p>
<ul>
<li><p><strong>Red rays - diffuse indirect paths</strong>: Diffusely scatter at two or more diffuse points.</p></li>
<li><p><strong>Green rays - sepcular indirect paths</strong>: Diffusely scatter at most once.</p></li>
</ul>
</li>
</ul>
<p>Important: Since the area of a camera pixel is not infinitely small, it usually receives both, rays from direct and indirect light paths.</p>
<p>The image captured with the camera can be imagined as a superposition of multiple latent images, all corresponding to different kinds of light paths.</p>
<p>The reconstruction of these latent images is one major goal of light transport analysis.</p>
<p>They often reveal interesting properties of the scene.</p>
</section>
<section id="teaser">
<h3>Teaser<a class="headerlink" href="#teaser" title="Permalink to this headline">#</a></h3>
<p>We will see, how we</p>
<ul class="simple">
<li><p>can synthetically relight a scene, i.e., synthesize the image that would result when illuminating it with arbitrary illumination patterns (see previous example images),</p></li>
</ul>
<ul class="simple">
<li><p>can manipulate the image of a projector in order to compensate disturbing structures on the screen surface,</p></li>
</ul>
<ul class="simple">
<li><p>can separate direct an indirect light transport to obtain images dominated only by the respective optical effects.</p></li>
</ul>
<section id="id2">
<h4>Example<a class="headerlink" href="#id2" title="Permalink to this headline">#</a></h4>
<img src="figures/4/Example_Separation_Direct_Indirect.svg" style="max-width:30vw"></section>
</section>
<section id="entries-of-the-light-transport-matrix">
<h3>Entries of the light transport matrix<a class="headerlink" href="#entries-of-the-light-transport-matrix" title="Permalink to this headline">#</a></h3>
<p>Each entry of <span class="math notranslate nohighlight">\(\mathbf{T}[m,n]\)</span> describes the ratio of radiant energy that is transmitted from light source <span class="math notranslate nohighlight">\(n\)</span> to sensor element <span class="math notranslate nohighlight">\(m\)</span> via all optical paths that somehow connect source <span class="math notranslate nohighlight">\(n\)</span> and sensor element <span class="math notranslate nohighlight">\(m\)</span>:</p>
<p><span class="math notranslate nohighlight">\(\begin{align} 
   T[m,n] = \int\limits_{\Omega_{m,n}} f(x) \mathrm{d} \mu (x)\,,
\end{align}\)</span></p>
<p>with <span class="math notranslate nohighlight">\(\Omega_{m,n}\)</span> denoting the support, i.e., the space of light paths between source <span class="math notranslate nohighlight">\(n\)</span> and sensor element <span class="math notranslate nohighlight">\(m\)</span>, the scattering throughput function <span class="math notranslate nohighlight">\(f(x)\)</span> encoding the radiant energy transported along a light path <span class="math notranslate nohighlight">\(x\)</span> and <span class="math notranslate nohighlight">\(\mu (x)\)</span> representing the corresponding measure.</p>
<section id="helmholtz-reciprocity-principle">
<h4>Helmholtz reciprocity principle<a class="headerlink" href="#helmholtz-reciprocity-principle" title="Permalink to this headline">#</a></h4>
<p>For many practically relevant scenes, the scattering throughput can be assumed to obey the <em>Helmholtz reciprocity principle</em>, according to which the value of <span class="math notranslate nohighlight">\(f(x)\)</span> for a light path <span class="math notranslate nohighlight">\(x\)</span> does not depend on the propagation direction of the light rays of <span class="math notranslate nohighlight">\(x\)</span> (i.e., interchanging projector pixel <span class="math notranslate nohighlight">\(n\)</span> with camera pixel <span class="math notranslate nohighlight">\(m\)</span> would result in the same value for <span class="math notranslate nohighlight">\(T[m,n]\)</span>).</p>
</section>
</section>
</section>
<section id="light-transport-analysis-via-optical-computing">
<h2>Light transport analysis via optical computing<a class="headerlink" href="#light-transport-analysis-via-optical-computing" title="Permalink to this headline">#</a></h2>
<p>When illuminating the scene with an illumination vector <span class="math notranslate nohighlight">\(\mathbf{p}\)</span>, capturing a camera image yields</p>
<p><span class="math notranslate nohighlight">\(\begin{align} 
   \mathbf{i} = \mathbf{T}\mathbf{p} \,,
\end{align}\)</span></p>
<p>i.e., the matrix multiplication <span class="math notranslate nohighlight">\(\mathbf{Tp}\)</span> has been performed in the optical domain.</p>
<p>This is the only possible way to interact with <span class="math notranslate nohighlight">\(\mathbf{T}\)</span> in order to get information about it, i.e., via multiplying <span class="math notranslate nohighlight">\(\mathbf{T}\)</span> with some vector <span class="math notranslate nohighlight">\(\mathbf{p}\)</span> and observing the result <span class="math notranslate nohighlight">\(\mathbf{i}\)</span>.</p>
<p>Luckily, dealing with very large matrices like <span class="math notranslate nohighlight">\(\mathbf{T}\)</span> only via matrix multiplication as stated before, represents a well-studied problem in the field of linear algebra.</p>
<p>Especially the set of so-called <em>Krylov subspace methods</em> is suitable for our case, which is why we will study some of these approaches in the following.</p>
<section id="optical-power-iteration">
<h3>Optical power iteration<a class="headerlink" href="#optical-power-iteration" title="Permalink to this headline">#</a></h3>
<p>We will first study a simple method to obtain the eigenvector <span class="math notranslate nohighlight">\(\mathbf{v}_1\)</span> of <span class="math notranslate nohighlight">\(\mathbf{T}\)</span> that corresponds to its largest eigenvalue <span class="math notranslate nohighlight">\(\lambda_1\)</span>. For this purpose, we will transform a method called <em>power iteration</em> into the optical domain.</p>
<p>The vector <span class="math notranslate nohighlight">\(\mathbf{v}\)</span> is called the eigenvector of a square matrix <span class="math notranslate nohighlight">\(\mathbf{T}\)</span> if</p>
<p><span class="math notranslate nohighlight">\(\begin{align} 
   \mathbf{Tv} = \lambda \mathbf{v} \,,
\end{align}\)</span></p>
<p>with the so-called scalar eigenvalue <span class="math notranslate nohighlight">\(\lambda\)</span>.</p>
<p>The eigenvector <span class="math notranslate nohighlight">\(\mathbf{v}_1\)</span> that corresponds to the eigenvalue <span class="math notranslate nohighlight">\(\lambda_1\)</span> with the highest absolute value is called the <em>principal eigenvector</em>.</p>
<section id="power-iteration">
<h4>Power iteration<a class="headerlink" href="#power-iteration" title="Permalink to this headline">#</a></h4>
<p>Power iteration is a simple numerical algorithm for calculating the principal eigenvector of a square matrix <span class="math notranslate nohighlight">\(\mathbf{T}\)</span>. It exploits the fact the sequence</p>
<p><span class="math notranslate nohighlight">\(\begin{align} 
   \mathbf{p}, \mathbf{Tp}, \mathbf{T}^2\mathbf{p}, \mathbf{T}^3\mathbf{p}, \ldots 
\end{align}\)</span></p>
<p>converges to the principal eigenvector <span class="math notranslate nohighlight">\(\mathbf{v}_1\)</span> of <span class="math notranslate nohighlight">\(\mathbf{T}\)</span> for any initial vector <span class="math notranslate nohighlight">\(\mathbf{p}\)</span>, that is not orthogonal to <span class="math notranslate nohighlight">\(\mathbf{v}_1\)</span>.</p>
</section>
<section id="implementation">
<h4>Implementation<a class="headerlink" href="#implementation" title="Permalink to this headline">#</a></h4>
<p>The typical implementation looks like:</p>
<p><span class="math notranslate nohighlight">\(\mathbf{Function}\, \mathrm{powerIteration}(\mathbf{T})\)</span><br><br>
<span class="math notranslate nohighlight">\(\quad \mathbf{p}_1 \leftarrow \text{ random vector}\)</span><br>
<span class="math notranslate nohighlight">\(\quad \mathbf{for}\, k \in [1,\ldots,K]:\)</span><br><br>
<span class="math notranslate nohighlight">\(\qquad \mathbf{i}_k \leftarrow \mathbf{Tp}_k\)</span><br>
<span class="math notranslate nohighlight">\(\qquad \mathbf{p}_{k+1} \leftarrow \frac{\mathbf{i}_k}{\left\| \mathbf{i}_k \right\|_2 }\)</span><br><br>
<span class="math notranslate nohighlight">\(\quad \textbf{return}\,  \mathbf{p}_{k+1}\)</span></p>
<p>The optical counterpart is given by:</p>
<p><span class="math notranslate nohighlight">\(\mathbf{Function}\, \mathrm{opticalPowerIteration}(\mathtt{camera},\, \mathtt{projector})\)</span><br><br>
<span class="math notranslate nohighlight">\(\quad \mathbf{p}_1 \leftarrow \text{ random vector}\)</span><br>
<span class="math notranslate nohighlight">\(\quad \mathbf{for}\, k \in [1,\ldots,K]:\)</span><br>
<span class="math notranslate nohighlight">\(\qquad \mathtt{projector}.\text{project}(\mathbf{p}_k)\)</span><br>
<span class="math notranslate nohighlight">\(\qquad \mathbf{i}_k \leftarrow \mathtt{camera}.\text{acquireImage}()\)</span><br>
<span class="math notranslate nohighlight">\(\qquad \mathbf{p}_{k+1} \leftarrow \frac{\mathbf{i}_k}{\left\| \mathbf{i}_k \right\|_2 }\)</span><br><br>
<span class="math notranslate nohighlight">\(\quad \textbf{return}\,  \mathbf{p}_{k+1}\)</span></p>
<p>Note that all elements of <span class="math notranslate nohighlight">\(\mathbf{p}\)</span> have to be non-negative so that they can be projected onto the scene.</p>
<p>Some intermediate steps of an example optical power iteration application:</p>
<img src="figures/4/powerIteration_example.svg" style="max-width:30vw"></section>
<section id="limitations">
<h4>Limitations<a class="headerlink" href="#limitations" title="Permalink to this headline">#</a></h4>
<ul class="simple">
<li><p>Power iteration can only be applied to square matrices (i.e., for same sizes of projected images and captured images).</p></li>
</ul>
<ul class="simple">
<li><p>The convergence behavior of power iteration strongly depends on properties of <span class="math notranslate nohighlight">\(\mathbf{T}\)</span>, especially on the similarity of the top two eigenvalues.</p></li>
</ul>
</section>
</section>
<section id="krylov-subspace-methods">
<h3>Krylov subspace methods<a class="headerlink" href="#krylov-subspace-methods" title="Permalink to this headline">#</a></h3>
<p>Krylov subspace methods represent a powerful family of algorithms for analyzing large sparse matrices <span class="math notranslate nohighlight">\(\mathbf{T}\)</span> whose shape can be square or rectangular. All they need is to perform multiplications with <span class="math notranslate nohighlight">\(\mathbf{T}\)</span> and sometimes with its transpose <span class="math notranslate nohighlight">\(\mathbf{T}\transp\)</span>.
<br>
Before we introduce the actual algorithms, we cover some prerequisites.</p>
<p>The Krylov subspace of dimension <span class="math notranslate nohighlight">\(k\)</span> is the span of vectors produced after <span class="math notranslate nohighlight">\(k\)</span> steps via power iteration, i.e.:</p>
<p><span class="math notranslate nohighlight">\(\begin{align} 
   \left( \mathbf{p}_1 , \mathbf{p}_2 = \mathbf{Tp}, \mathbf{p}_3 = \mathbf{T}^2 \mathbf{p}_1 , \ldots , \mathbf{p}_{k+1} = \mathbf{T}^k \mathbf{p}_1 \right) \,.
\end{align}\)</span></p>
<section id="optical-matrix-vector-multiplication-for-arbitrary-vectors">
<h4>Optical matrix-vector multiplication for arbitrary vectors<a class="headerlink" href="#optical-matrix-vector-multiplication-for-arbitrary-vectors" title="Permalink to this headline">#</a></h4>
<p>Krylov subspace methods require to compute products with <span class="math notranslate nohighlight">\(\mathbf{T}\)</span> for arbitrary vectors <span class="math notranslate nohighlight">\(\mathbf{p}\)</span>, which may also contain negative values.</p>
<p>For this purpose, we express <span class="math notranslate nohighlight">\(\mathbf{p}\)</span> as the difference between two non-negative vectors <span class="math notranslate nohighlight">\(\mathbf{p}^+\)</span> and <span class="math notranslate nohighlight">\(\mathbf{p}^-\)</span>:</p>
<p><span class="math notranslate nohighlight">\(\begin{align} 
   \mathbf{p} &amp;= \mathbf{p}^+ - \mathbf{p}^- \\
   \mathbf{Tp} &amp;= \mathbf{Tp}^+ - \mathbf{Tp}^- \,.
\end{align}\)</span></p>
<p>As a result, we have to project and capture two images to achieve an optical realization of these kinds of matrix-vector multiplications.</p>
</section>
<section id="symmetry-of-transport-matrix">
<h4>Symmetry of transport matrix<a class="headerlink" href="#symmetry-of-transport-matrix" title="Permalink to this headline">#</a></h4>
<p>Only for symmetric matrices the convergence characteristics of Krylov subspace are well-understood and promise fast convergence. Hence, we stick to that case and ensure optically that the light transport matrix <span class="math notranslate nohighlight">\(\mathbf{T}\)</span> is symmetric.</p>
<p>However, by using two camera-projector systems, two unsymmetric transport matrices can be combined into one symmetric light transport matrix (not covered here).</p>
<section id="enforcing-symmetry-for-mathbf-t">
<h5>Enforcing symmetry for <span class="math notranslate nohighlight">\(\mathbf{T}\)</span><a class="headerlink" href="#enforcing-symmetry-for-mathbf-t" title="Permalink to this headline">#</a></h5>
<p>By using a coaxial camera-projector arrangement and equal resolutions for both components, the symmetry of <span class="math notranslate nohighlight">\(\mathbf{T}\)</span> can be guaranteed due to Helmholtz reciprocity (see the following figure).</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">interact</span><span class="p">(</span><span class="k">lambda</span> <span class="n">i</span><span class="p">:</span> <span class="n">showFig</span><span class="p">(</span><span class="s1">&#39;figures/4/symmetric_transport_matrix_&#39;</span><span class="p">,</span><span class="n">i</span><span class="p">,</span><span class="s1">&#39;.svg&#39;</span><span class="p">,</span><span class="mi">800</span><span class="p">,</span><span class="mi">50</span><span class="p">),</span> <span class="n">i</span><span class="o">=</span><span class="n">widgets</span><span class="o">.</span><span class="n">IntSlider</span><span class="p">(</span><span class="nb">min</span><span class="o">=</span><span class="p">(</span><span class="n">min_i</span><span class="o">:=</span><span class="mi">1</span><span class="p">),</span><span class="nb">max</span><span class="o">=</span><span class="p">(</span><span class="n">max_i</span><span class="o">:=</span><span class="mi">7</span><span class="p">),</span> <span class="n">step</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">value</span><span class="o">=</span><span class="p">(</span><span class="n">max_i</span> <span class="k">if</span> <span class="n">book</span> <span class="k">else</span> <span class="n">min_i</span><span class="p">)))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<script type="application/vnd.jupyter.widget-view+json">
{"version_major": 2, "version_minor": 0, "model_id": "8c185786758944ec9da33ba38e7eaeaf"}
</script><div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&lt;function __main__.&lt;lambda&gt;(i)&gt;
</pre></div>
</div>
</div>
</div>
</section>
</section>
<section id="low-rank-approximation-of-mathbf-t-via-optical-arnoldi">
<h4>Low-rank approximation of <span class="math notranslate nohighlight">\(\mathbf{T}\)</span> via optical Arnoldi<a class="headerlink" href="#low-rank-approximation-of-mathbf-t-via-optical-arnoldi" title="Permalink to this headline">#</a></h4>
<p>In its <span class="math notranslate nohighlight">\(k\)</span>-th iteration, the Arnoldi method allows to calculate the top <span class="math notranslate nohighlight">\(k\)</span> eigenvectors (or singular vectors) of a matrix.</p>
<p>It calculates a sequence of orthogonal vectors <span class="math notranslate nohighlight">\(\mathbf{p}_1, \ldots, \mathbf{p}_k\)</span> whose span is an approximation of the span of the top <span class="math notranslate nohighlight">\(k\)</span> eigenvectors of the matrix under investigation.</p>
<p>The accuracy of the approximation increases with <span class="math notranslate nohighlight">\(k\)</span>.</p>
<p><span class="math notranslate nohighlight">\(\mathbf{Function}\, \mathrm{opticalSymmetricArnoldi}(\mathtt{camera},\, \mathtt{projector})\)</span><br><br>
<span class="math notranslate nohighlight">\(\quad \mathbf{p}_1 \leftarrow \text{ non-zero random vector}\)</span><br>
<span class="math notranslate nohighlight">\(\quad \mathbf{for}\, k \in [1,\ldots,K]:\)</span><br>
<span class="math notranslate nohighlight">\(\qquad \mathtt{projector}.\text{project}(\mathbf{p}^+_k)\)</span><br>
<span class="math notranslate nohighlight">\(\qquad \mathbf{i}^+_k \leftarrow \mathtt{camera}.\text{acquireImage}()\)</span><br>
<span class="math notranslate nohighlight">\(\qquad \mathtt{projector}.\text{project}(\mathbf{p}^-_k)\)</span><br>
<span class="math notranslate nohighlight">\(\qquad \mathbf{i}^-_k \leftarrow \mathtt{camera}.\text{acquireImage}()\)</span><br>
<span class="math notranslate nohighlight">\(\qquad \mathbf{i}_k \leftarrow i^+_k - i^-_k\)</span><br>
<span class="math notranslate nohighlight">\(\qquad \mathbf{p}_{k+1} \leftarrow \text{ortho}(\mathbf{p}_1, \ldots ,\mathbf{p}_k,\mathbf{i}_k)\)</span><br>
<span class="math notranslate nohighlight">\(\qquad \mathbf{p}_{k+1} \leftarrow \frac{\mathbf{p}_{k+1}}{\left\| \mathbf{p}_{k+1} \right\|_2 }\)</span><br><br>
<span class="math notranslate nohighlight">\(\quad \textbf{return}\,  \left[ \mathbf{i}_1 \cdots \mathbf{i}_{K} \right] \left[ \mathbf{p}_1 \cdots \mathbf{p}_K  \right]\transp  \)</span></p>
<p>The function <span class="math notranslate nohighlight">\(\text{ortho}(\mathbf{p}_1, \ldots ,\mathbf{p}_k,\mathbf{i}_k)\)</span> projects its last argument <span class="math notranslate nohighlight">\(\mathbf{i}_k\)</span> onto the subspace orthogonal to the columns of the matrix <span class="math notranslate nohighlight">\(\mathbf{P} = [\mathbf{p}_1, \mathbf{p}_2, \ldots, \mathbf{p}_k]\)</span>, i.e.,</p>
<p><span class="math notranslate nohighlight">\(\begin{align} 
  \text{ortho}(\mathbf{p}_1, \ldots ,\mathbf{p}_k,\mathbf{i}_k) = \mathbf{i}_k - \mathbf{P}\left( \mathbf{P}\transp \mathbf{P} \right)^{-1}  \mathbf{P}\transp \mathbf{i}_k
\end{align}\)</span></p>
<p>The Arnoldi algorithm constructs an orthogonal basis <span class="math notranslate nohighlight">\(\left[ \mathbf{p}_1 \cdots \mathbf{p}_K  \right]\)</span> for the subspace of illumination vectors and a basis <span class="math notranslate nohighlight">\(\left[ \mathbf{i}_1 \cdots \mathbf{i}_{K} \right]\)</span> for the subspace of acquired images. The product <span class="math notranslate nohighlight">\(\left[ \mathbf{i}_1 \cdots \mathbf{i}_{K} \right] \left[ \mathbf{p}_1 \cdots \mathbf{p}_K  \right]\transp\)</span> is a low-rank approximation of <span class="math notranslate nohighlight">\(\mathbf{T}\)</span>.</p>
<p>In order to synthetically relight the scene with an arbitrary illumination <span class="math notranslate nohighlight">\(\mathbf{p}\)</span>, the following expression has to be evaluated:</p>
<p><span class="math notranslate nohighlight">\(\begin{align} 
   \mathbf{Tp} \approx \left[ \mathbf{i}_1 \cdots \mathbf{i}_{K} \right] \left[ \mathbf{p}_1 \cdots \mathbf{p}_K  \right]\transp \mathbf{p} \,.
\end{align}\)</span></p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>If this equation is successively evaluated from right to left, at no time a matrix larger than <span class="math notranslate nohighlight">\(K \times N\)</span> has to be kept in memory.</p>
</div>
</section>
<section id="optical-matrix-inversion-via-gmres">
<h4>Optical matrix inversion via GMRES<a class="headerlink" href="#optical-matrix-inversion-via-gmres" title="Permalink to this headline">#</a></h4>
<p>We now assume that we are given a camera image <span class="math notranslate nohighlight">\(\mathbf{i}\)</span> of our scene and want to obtain the illumination <span class="math notranslate nohighlight">\(\mathbf{p}\)</span> that produced it, i.e., we want to find</p>
<p><span class="math notranslate nohighlight">\(\begin{align} 
   \mathbf{p} = \argmin{\mathbf{x}} \left\| \left[ \mathbf{i}_1 \cdots \mathbf{i}_{K} \right] \left[ \mathbf{p}_1 \cdots \mathbf{p}_K  \right]\transp \mathbf{x} - \mathbf{i} \right\|_2 \,. 
\end{align}\)</span></p>
<p>This optimization problem can be solved via the Moore-Penrose pseudoinverse <span class="math notranslate nohighlight">\(\mathbf{T}^\dagger\)</span> of <span class="math notranslate nohighlight">\(\mathbf{T}\)</span> (in order to account for a potentially singular matrix <span class="math notranslate nohighlight">\(\mathbf{T}\)</span>):</p>
<p><span class="math notranslate nohighlight">\(\begin{align} 
   \mathbf{p} = \mathbf{T}^\dagger \mathbf{i}\,.
\end{align}\)</span></p>
<p>This solution can also be calculated optically via another popular Krylov subspace method called <em>generalized minimum residual (GMRES)</em> that also only relies on computing products with <span class="math notranslate nohighlight">\(\mathbf{T}\)</span> and does not need to access to the complete matrix.</p>
<p>The algorithm differs only slightly from optical Arnoldi, namely</p>
<ul class="simple">
<li><p>in the initialization vector <span class="math notranslate nohighlight">\(\mathbf{p}_1\)</span>, which is always the target image <span class="math notranslate nohighlight">\(\mathbf{i}\)</span> and</p></li>
<li><p>in the return value, which is <span class="math notranslate nohighlight">\(\left[ \mathbf{i}_1 \cdots \mathbf{i}_{K} \right] \left[ \mathbf{p}_1 \cdots \mathbf{p}_K  \right]^\dagger \mathbf{i}\)</span>, i.e., the approximation of the sought illumination vector.</p></li>
</ul>
<p><span class="math notranslate nohighlight">\(\mathbf{Function}\, \mathrm{opticalSymmetricGMRES}(\mathtt{camera},\, \mathtt{projector}, \mathbf{i})\)</span><br><br>
<span class="math notranslate nohighlight">\(\quad \mathbf{p}_1 \leftarrow \mathbf{i}\)</span><br>
<span class="math notranslate nohighlight">\(\quad \mathbf{for}\, k \in [1,\ldots,K]:\)</span><br>
<span class="math notranslate nohighlight">\(\qquad \mathtt{projector}.\text{project}(\mathbf{p}^+_k)\)</span><br>
<span class="math notranslate nohighlight">\(\qquad \mathbf{i}^+_k \leftarrow \mathtt{camera}.\text{acquireImage}()\)</span><br>
<span class="math notranslate nohighlight">\(\qquad \mathtt{projector}.\text{project}(\mathbf{p}^-_k)\)</span><br>
<span class="math notranslate nohighlight">\(\qquad \mathbf{i}^-_k \leftarrow \mathtt{camera}.\text{acquireImage}()\)</span><br>
<span class="math notranslate nohighlight">\(\qquad \mathbf{i}_k \leftarrow i^+_k - i^-_k\)</span><br>
<span class="math notranslate nohighlight">\(\qquad \mathbf{p}_{k+1} \leftarrow \text{ortho}(\mathbf{p}_1, \ldots ,\mathbf{p}_k,\mathbf{i}_k)\)</span><br>
<span class="math notranslate nohighlight">\(\qquad \mathbf{p}_{k+1} \leftarrow \frac{\mathbf{p}_{k+1}}{\left\| \mathbf{p}_{k+1} \right\|_2 }\)</span><br><br>
<span class="math notranslate nohighlight">\(\quad \textbf{return}\,  \left[ \mathbf{i}_1 \cdots \mathbf{i}_{K} \right] \left[ \mathbf{p}_1 \cdots \mathbf{p}_K  \right]^\dagger \mathbf{i}  \)</span></p>
<p>Intuitively, GMRES calculates a rank-<span class="math notranslate nohighlight">\(K\)</span> approximation of <span class="math notranslate nohighlight">\(\mathbf{T}\)</span> and calculates its pseudoinverse to solve for <span class="math notranslate nohighlight">\(\mathbf{p}\)</span>. The initialization of <span class="math notranslate nohighlight">\(\mathbf{p}_1\)</span> with <span class="math notranslate nohighlight">\(\mathbf{i}\)</span> helps to explore only a portion of <span class="math notranslate nohighlight">\(\mathbf{T}\)</span>’s row space that is suitable for the inversion with respect to <span class="math notranslate nohighlight">\(\mathbf{i}\)</span>.</p>
<section id="example-experiments">
<h5>Example experiments<a class="headerlink" href="#example-experiments" title="Permalink to this headline">#</a></h5>
<img src="figures/4/result_GMRES.svg" style="max-width:30vw"></section>
</section>
</section>
</section>
<section id="primal-dual-coding-for-optical-probing">
<h2>Primal-Dual coding for optical probing<a class="headerlink" href="#primal-dual-coding-for-optical-probing" title="Permalink to this headline">#</a></h2>
<p><em>Optical probing</em> can be seen as the optical implementation of <em>matrix probing</em>, a topic of numerical mathematics dealing with the efficient estimation of special regions of interest of very large matrices (like <span class="math notranslate nohighlight">\(\mathbf{T}\)</span>), e.g., its trace or diagonal.</p>
<p>Optical probing allows to obtain certain latent images of the scene which are normally hidden in the global light transport.</p>
<p>For example, it is possible to obtain images corresponding to either (approximately) only direct or (approximately) only indirect light transport. Such images can reveal interesting insights about the observed scene (e.g., the structure of the blood vessels under the skin).</p>
<p>Optical probing can be mathematically modelled as</p>
<p><span class="math notranslate nohighlight">\(\begin{align} 
   \mathbf{i} = \left( \boldsymbol{\Pi} \odot \mathbf{T} \right) \mathbf{1} \,,
\end{align}\)</span></p>
<p>with <span class="math notranslate nohighlight">\(\boldsymbol{\Pi}\)</span> denoting the <em>probing matrix</em> and <span class="math notranslate nohighlight">\(\odot\)</span> denoting the element-wise product between two matrices of equal size, <span class="math notranslate nohighlight">\(\mathbf{1}\)</span> denoting a vector of all ones representing a uniform illumination and finally <span class="math notranslate nohighlight">\(\mathbf{i}\)</span> representing the image captured under uniform illumination and for a light transport matrix that is the result of <span class="math notranslate nohighlight">\(\boldsymbol{\Pi} \odot \mathbf{T}\)</span>.</p>
<p>Visualization of the probing equation:<br></p>
<img src="figures/4/probing_equation.svg" style="max-width:30vw"><p>In order to be able to manipulate <span class="math notranslate nohighlight">\(\mathbf{T}\)</span> in this way, it is necessary to control two aspects of the image formation process:</p>
<ul class="simple">
<li><p>the illumination, the so-called <em>primal domain</em> via the projected image and</p></li>
<li><p>the pixel-wise modulation of the camera’s sensor, the so-called <em>dual domain</em>.</p></li>
</ul>
<p>Controlling the dual domain means, that certain pixels of the camera can be blocked from receiving light during the acquisition of a single camera image.</p>
<p>This can be achieved</p>
<ul class="simple">
<li><p>via a so-called spatial light modulator, i.e., a transmission mask (e.g., an LCD panel) whose spatial transmission pattern can be computationally controlled or</p></li>
</ul>
<ul class="simple">
<li><p>by capturing single images <span class="math notranslate nohighlight">\(\mathbf{i}_k\)</span> for every modulation pattern <span class="math notranslate nohighlight">\(k\in [0,\ldots, K]\)</span> where the respective pixel values are computationally modulated after the image acquisition and by synthesizing the actual image by calculating a sum over all <span class="math notranslate nohighlight">\(\mathbf{i}_k\)</span>.</p></li>
</ul>
<p>Visualization of the optical setup:<br></p>
<img src="figures/4/probing_setup.svg" style="max-width:30vw"><section id="probing-the-light-transport-matrix">
<h3>Probing the light transport matrix<a class="headerlink" href="#probing-the-light-transport-matrix" title="Permalink to this headline">#</a></h3>
<p>The only way we can gain information about the light transport (matrix) is by projecting and capturing images.</p>
<p>However, this leaves a notable dimensionality gap:</p>
<ul class="simple">
<li><p><span class="math notranslate nohighlight">\(\mathbf{T}\)</span> has <span class="math notranslate nohighlight">\(I \times P\)</span> elements, whereas</p></li>
<li><p>one image <span class="math notranslate nohighlight">\(\mathbf{i}\)</span> only as <span class="math notranslate nohighlight">\(I\)</span> elements.</p></li>
</ul>
<p><span class="math notranslate nohighlight">\(\Rightarrow\)</span> Use probing equation to only analyze elements of <span class="math notranslate nohighlight">\(\mathbf{T}\)</span> of interest.</p>
<section id="example-probing-matrices">
<h4>Example probing matrices<a class="headerlink" href="#example-probing-matrices" title="Permalink to this headline">#</a></h4>
<img src="figures/4/example_probing_matrix_1.svg" style="max-width:30vw">
<p>Acquisition of a common image for illumination <span class="math notranslate nohighlight">\(\mathbf{p}\)</span>.</p>
<img src="figures/4/example_probing_matrix_2.svg" style="max-width:30vw">
<p>Same as before but via probing matrix and constant illumination <span class="math notranslate nohighlight">\(\mathbf{1}\)</span>.</p>
<img src="figures/4/example_probing_matrix_3.svg" style="max-width:30vw">
<p>Acquisition of the diagonal of <span class="math notranslate nohighlight">\(\mathbf{T}\)</span>.</p>
<img src="figures/4/example_probing_matrix_4.svg" style="max-width:30vw">
<p>Acquisition of an off-diagonal of <span class="math notranslate nohighlight">\(\mathbf{T}\)</span>.</p>
<img src="figures/4/example_probing_matrix_5.svg" style="max-width:30vw">
<p>Acquisition of one specific element of <span class="math notranslate nohighlight">\(\mathbf{T}\)</span> per row.</p>
<img src="figures/4/example_probing_matrix_6.svg" style="max-width:30vw">
<p>Acquisition of a linear combination of two elements (red and blue) of <span class="math notranslate nohighlight">\(\mathbf{T}\)</span> per row.</p>
<img src="figures/4/example_probing_matrix_7.svg" style="max-width:30vw">
<p>Acquisition of an image for illumination <span class="math notranslate nohighlight">\(\mathbf{p}\)</span> for a transport matrix <span class="math notranslate nohighlight">\(\hat{\mathbf{T}}=\mathbf{A}\odot \mathbf{T}\)</span>.</p>
<p>Each element <span class="math notranslate nohighlight">\((m,n)\)</span> of <span class="math notranslate nohighlight">\(\mathbf{T}\)</span> encodes different optical paths of light that originated from projector pixel <span class="math notranslate nohighlight">\(n\)</span> and reach camera pixel <span class="math notranslate nohighlight">\(m\)</span>.</p>
<img src="figures/4/probing_light_paths.svg" style="max-height:40vh"><ul class="simple">
<li><p>(a): <span class="math notranslate nohighlight">\(\mathbf{T}[m,n]\)</span>: All light paths from projector pixel <span class="math notranslate nohighlight">\(n\)</span> to camera pixel <span class="math notranslate nohighlight">\(m\)</span>.</p></li>
<li><p>(b): <span class="math notranslate nohighlight">\(\mathbf{T}[m,m]\)</span>, i.e., diagonal of <span class="math notranslate nohighlight">\(\mathbf{T}\)</span>: The direct component (red) but maybe also back-scattering (blue) and retro reflections (green).</p></li>
<li><p>(c): The distance <span class="math notranslate nohighlight">\(\left| m-n \right|\)</span> allows to distinguish between short distance and long distance optical paths.</p></li>
</ul>
<p>By adequately probing <span class="math notranslate nohighlight">\(\mathbf{T}\)</span>, photos can be acquired, for which certain light paths (e.g., direct, indirect, etc.) have been enhanced, attenuated or even blocked.</p>
<section id="how-to-perform-the-probing">
<h5>How to perform the probing?<a class="headerlink" href="#how-to-perform-the-probing" title="Permalink to this headline">#</a></h5>
<p>Naive idea: To probe <span class="math notranslate nohighlight">\(\mathbf{T}[m,n]\)</span>, illuminate with a single projector pixel <span class="math notranslate nohighlight">\(n\)</span> while reading out only camera pixel <span class="math notranslate nohighlight">\(m\)</span>, repeat for all non-zero elements of the probing matrix <span class="math notranslate nohighlight">\(\boldsymbol{\Pi}\)</span>.</p>
<p><span class="math notranslate nohighlight">\(\Rightarrow\)</span> Very inefficient (in terms of light) and slow!</p>
</section>
</section>
<section id="optical-implementation-of-matrix-probing">
<h4>Optical implementation of matrix probing<a class="headerlink" href="#optical-implementation-of-matrix-probing" title="Permalink to this headline">#</a></h4>
<p>Decompose <span class="math notranslate nohighlight">\(\boldsymbol{\Pi}\)</span> into a sum of rank-1 matrices:</p>
<p><span class="math notranslate nohighlight">\(\begin{align} 
   \boldsymbol{\Pi} = \sum\limits^K_{k=1} \mathbf{m}_k \mathbf{p}^\intercal_k \,,
\end{align}\)</span></p>
<p>for <span class="math notranslate nohighlight">\(K\)</span> vectors <span class="math notranslate nohighlight">\(\mathbf{m}_k, \mathbf{p}_k\)</span>.</p>
<p>With this, we can reformulate the probing equation:</p>
<p><span class="math notranslate nohighlight">\(\begin{align} 
   \left( \boldsymbol{\Pi} \odot \mathbf{T} \right) \mathbf{1} &amp;= \sum\limits^P_{n=1} \boldsymbol{\Pi} [n] \circ \mathbf{T}[n] \\
   &amp;= \sum\limits^P_{n=1} \left( \sum\limits^K_{k=1} \mathbf{m}_k p_k[n] \right) \circ \mathbf{T}[n] \\
   &amp;= \sum\limits^K_{k=1} \left( \mathbf{m}_k \circ \sum\limits^P_{n=1} \mathbf{T}[n]p_k[n] \right) \\
   &amp;= \sum\limits^K_{k=1} \mathbf{m}_k \circ \mathbf{T}\mathbf{p}_k \,,
\end{align}\)</span></p>
<p>with <span class="math notranslate nohighlight">\(\circ\)</span> denoting the element-wise product between vectors, <span class="math notranslate nohighlight">\(\mathbf{T}[n]\)</span> denoting the <span class="math notranslate nohighlight">\(n\)</span>-th column of <span class="math notranslate nohighlight">\(\mathbf{T}\)</span> and <span class="math notranslate nohighlight">\(p_k[n]\)</span> denoting the <span class="math notranslate nohighlight">\(n\)</span>-th element of the vector <span class="math notranslate nohighlight">\(\mathbf{p}_k\)</span>, i.e., <span class="math notranslate nohighlight">\(p_k[n]\)</span> is a scalar.</p>
<p>According to this derivation, every decomposition of the probing matrix into a sum of rank-1 matrices can be realized via a sequence of step-wise corresponding illumination patterns <span class="math notranslate nohighlight">\(\mathbf{p}_k\)</span> and sensor modulations <span class="math notranslate nohighlight">\(\mathbf{m}_k\)</span> for <span class="math notranslate nohighlight">\(k \in [1,\ldots, K]\)</span>:</p>
<p><span class="math notranslate nohighlight">\(\begin{align} 
    \left( \boldsymbol{\Pi} \odot \mathbf{T} \right) \mathbf{1} = \sum\limits^K_{k=1} \underbrace{\mathbf{m}_k \circ \overbrace{\mathbf{T}\mathbf{p}_k}^{\text{acquired image } \mathbf{i}_k \text{ for illumination }\mathbf{p}_k}}_{\text{image } \mathbf{i}_k \text{ modulated with } \mathbf{m}_k} \,.
\end{align}\)</span></p>
<p>This leads to the following algorithm for optical probing of the light transport matrix:</p>
<p><span class="math notranslate nohighlight">\(\mathbf{Function}\, \mathrm{opticalMatrixProbing}\left(\mathtt{camera},\, \mathtt{projector}, \left\{ \mathbf{p}_k, k \in \left[ 1,\ldots, K \right]  \right\}, \left\{ \mathbf{m}_k, k \in \left[ 1,\ldots, K \right]  \right\}  \right)\)</span><br><br>
<span class="math notranslate nohighlight">\(\quad \mathbf{i}_{\mathrm{result}} \leftarrow \text{ empty image }\)</span><br>
<span class="math notranslate nohighlight">\(\quad \mathbf{for}\, k \in [1,\ldots,K]:\)</span><br>
<span class="math notranslate nohighlight">\(\qquad \mathtt{projector}.\text{project}(\mathbf{p}_k)\)</span><br>
<span class="math notranslate nohighlight">\(\qquad \mathbf{i}_k \leftarrow \mathtt{camera}.\text{acquireImage}()\)</span><br>
<span class="math notranslate nohighlight">\(\qquad \mathbf{i}_{\mathrm{result}} \leftarrow \mathbf{i}_\mathrm{result} +  \mathbf{m}_k \circ \mathbf{i}_k\)</span><br><br></p>
<p><span class="math notranslate nohighlight">\(\quad \textbf{return}\,  \mathbf{i}_\mathrm{result}\)</span></p>
</section>
<section id="enhancing-the-direct-component">
<h4>Enhancing the direct component<a class="headerlink" href="#enhancing-the-direct-component" title="Permalink to this headline">#</a></h4>
<p>For enhancing the direct component, i.e., the diagonal of <span class="math notranslate nohighlight">\(\mathbf{T}\)</span>, one can use a sequence of <span class="math notranslate nohighlight">\(\mathbf{p}_k = \mathbf{m}_k\)</span> drawn from the Bernoulli distribution. The resulting vectors have values of 1 with probability <span class="math notranslate nohighlight">\(p\)</span> and <span class="math notranslate nohighlight">\(0\)</span> with probability <span class="math notranslate nohighlight">\(1-p\)</span>. When drawing <span class="math notranslate nohighlight">\(K\)</span> vectors, their approximated matrix converges to a probing matrix with <span class="math notranslate nohighlight">\(p\cdot K\)</span> on the diagonal and <span class="math notranslate nohighlight">\(p^2 \cdot K\)</span> everywhere else, i.e., enhancing the diagonal of <span class="math notranslate nohighlight">\(\mathbf{T}\)</span> by a factor of <span class="math notranslate nohighlight">\(\frac{p \cdot K}{p^2 \cdot K} = \frac{1}{p}\)</span>.</p>
<p>Example approximated probing matrix for enhancing the direct component with size <span class="math notranslate nohighlight">\(10 \times 10\)</span> resulting from the described method for <span class="math notranslate nohighlight">\(p=0.125, K=1000\)</span>.</p>
<img src="figures/4/approx_prob_mat_direct_enhanced.svg" style="max-width:30vw"><p>Example results for enhancing the direct light path components via different values for <span class="math notranslate nohighlight">\(p\)</span>:</p>
<img src="figures/4/example_direct_enhanced.svg" style="max-width:30vw"></section>
<section id="attenuation-of-local-scattering">
<h4>Attenuation of local scattering<a class="headerlink" href="#attenuation-of-local-scattering" title="Permalink to this headline">#</a></h4>
<p>When light from a projector pixel <span class="math notranslate nohighlight">\(n\)</span> is locally scattered by small structures, e.g., by dust particles, it will most likely not contribute to the camera pixel <span class="math notranslate nohighlight">\(n\)</span>, which corresponds to direct light transport, but to a nearby camera pixel <span class="math notranslate nohighlight">\(m\)</span>, i.e., with <span class="math notranslate nohighlight">\(\vert m - n \vert = 1\)</span>.</p>
<p>Such light transport phenomena are encoded by the first off-diagonal of <span class="math notranslate nohighlight">\(\mathbf{T}\)</span>.</p>
<p>In order to attenuate local scattering effects, first an image <span class="math notranslate nohighlight">\(\mathbf{i}_2\)</span> is acquired, where these effects are enhanced. This image can then be subtracted from an image <span class="math notranslate nohighlight">\(\mathbf{i}_1\)</span> with enhanced direct light transport (previous example) to obtain the final image <span class="math notranslate nohighlight">\(\mathbf{i}_3 = \mathbf{i}_1 - \mathbf{i}_2\)</span>.</p>
<p>To approximate the probing matrix for acquiring the off-diagonal of <span class="math notranslate nohighlight">\(\mathbf{T}\)</span>, the previously mentioned Bernoulli sequence can be used for <span class="math notranslate nohighlight">\(\mathbf{m}_k\)</span> and the illumination vectors have to be shifted by <span class="math notranslate nohighlight">\(w\)</span> for probing the <span class="math notranslate nohighlight">\(w\)</span>-th off-diagonal:</p>
<p><span class="math notranslate nohighlight">\(\begin{align} 
   \mathbf{p}_k := \text{shift}(\mathbf{m}_k, w)\,.
\end{align}\)</span></p>
<p>The operation <span class="math notranslate nohighlight">\(\text{shift}(\mathbf{m}_k, w)\)</span> denotes a circular shift of the vector <span class="math notranslate nohighlight">\(\mathbf{m}_k\)</span> by <span class="math notranslate nohighlight">\(w\)</span>, i.e.,</p>
<p><span class="math notranslate nohighlight">\(\begin{align} 
   \text{shift}(\mathbf{x}, w) &amp;= \text{shift}\left( (x_1, x_2, \ldots, x_N)\transp , w \right) \\ &amp;= (x_{N-(w-1) \text{ mod }N}, x_{N-(w-2) \text{ mod }N}, \ldots, x_{N-(w-N) \text{ mod }N})\transp \,.
\end{align}\)</span></p>
<section id="id3">
<h5>Example<a class="headerlink" href="#id3" title="Permalink to this headline">#</a></h5>
<p>Imaging a test chart in turbid media (milky water) as an example scene for strong local scattering effects.</p>
<p>Without compensation:</p>
<img src="figures/4/example_descattering_conventional.svg" style="max-width:30vw"><p>Results for attenuation of local scattering effects:</p>
<img src="figures/4/example_descattering.svg" style="max-height:90vh"><p>Example approximation of a <span class="math notranslate nohighlight">\(10 \times 10\)</span> probing matrix (same parameters as before, i.e., <span class="math notranslate nohighlight">\(p=0.125, K=1000\)</span>) for enhancing the first off-diagonal:</p>
<img src="figures/4/approx_prob_mat_offdiag_enhanced.svg" style="max-width:30vw"><p>Similar approximation for the probing matrix that would result for the subtraction <span class="math notranslate nohighlight">\(\mathbf{i}_3 = \mathbf{i}_1 - \mathbf{i}_2\)</span>:</p>
<img src="figures/4/approx_prob_mat_local_descattering.svg" style="max-width:30vw"></section>
</section>
<section id="only-indirect-light-transport">
<h4>Only indirect light transport<a class="headerlink" href="#only-indirect-light-transport" title="Permalink to this headline">#</a></h4>
<p>To suppress direct light transport, the illumination vectors <span class="math notranslate nohighlight">\(\mathbf{p}_k\)</span> can be drawn from the Bernoulli distribution and the mask patterns can be set as <span class="math notranslate nohighlight">\(\mathbf{m}_k := \mathbf{1} - \mathbf{p}_k\)</span>.</p>
<p>The resulting approximated matrix will have <span class="math notranslate nohighlight">\(0\)</span> on its diagonal and an expected value of <span class="math notranslate nohighlight">\(p(1-p)\cdot K\)</span> everywhere else.</p>
<p>Example approximated probing matrix for suppressing the direct component with size <span class="math notranslate nohighlight">\(10 \times 10\)</span> resulting from the described method for <span class="math notranslate nohighlight">\(p=0.1, K=1000\)</span>.</p>
<img src="figures/4/approx_prob_mat_indirect_only.svg" style="max-width:30vw"><p>Example results for only indirect light transport imaging and for enhancing the direct component via subtraction of the indirect only-image from an image acquired under constant illumination:</p>
<img src="figures/4/example_indirect_etc_1.svg" style="max-width:30vw"><img src="figures/4/example_indirect_etc_2.svg" style="max-width:30vw"></section>
</section>
</section>
</section>


<script type="application/vnd.jupyter.widget-state+json">
{"state": {"d9ec6866710545d28bbb11217aac496f": {"model_name": "LayoutModel", "model_module": "@jupyter-widgets/base", "model_module_version": "1.2.0", "state": {"_model_module": "@jupyter-widgets/base", "_model_module_version": "1.2.0", "_model_name": "LayoutModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "1.2.0", "_view_name": "LayoutView", "align_content": null, "align_items": null, "align_self": null, "border": null, "bottom": null, "display": null, "flex": null, "flex_flow": null, "grid_area": null, "grid_auto_columns": null, "grid_auto_flow": null, "grid_auto_rows": null, "grid_column": null, "grid_gap": null, "grid_row": null, "grid_template_areas": null, "grid_template_columns": null, "grid_template_rows": null, "height": null, "justify_content": null, "justify_items": null, "left": null, "margin": null, "max_height": null, "max_width": null, "min_height": null, "min_width": null, "object_fit": null, "object_position": null, "order": null, "overflow": null, "overflow_x": null, "overflow_y": null, "padding": null, "right": null, "top": null, "visibility": null, "width": null}}, "b9f9fb9e635b48f783077172f3bb3b67": {"model_name": "SliderStyleModel", "model_module": "@jupyter-widgets/controls", "model_module_version": "1.5.0", "state": {"_model_module": "@jupyter-widgets/controls", "_model_module_version": "1.5.0", "_model_name": "SliderStyleModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "1.2.0", "_view_name": "StyleView", "description_width": "", "handle_color": null}}, "515978bf84c04c7abe3ecc2f2f1176e6": {"model_name": "IntSliderModel", "model_module": "@jupyter-widgets/controls", "model_module_version": "1.5.0", "state": {"_dom_classes": [], "_model_module": "@jupyter-widgets/controls", "_model_module_version": "1.5.0", "_model_name": "IntSliderModel", "_view_count": null, "_view_module": "@jupyter-widgets/controls", "_view_module_version": "1.5.0", "_view_name": "IntSliderView", "continuous_update": true, "description": "i", "description_tooltip": null, "disabled": false, "layout": "IPY_MODEL_d9ec6866710545d28bbb11217aac496f", "max": 5, "min": 1, "orientation": "horizontal", "readout": true, "readout_format": "d", "step": 1, "style": "IPY_MODEL_b9f9fb9e635b48f783077172f3bb3b67", "value": 5}}, "02cd22ca8e30474cb6382829faa26295": {"model_name": "LayoutModel", "model_module": "@jupyter-widgets/base", "model_module_version": "1.2.0", "state": {"_model_module": "@jupyter-widgets/base", "_model_module_version": "1.2.0", "_model_name": "LayoutModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "1.2.0", "_view_name": "LayoutView", "align_content": null, "align_items": null, "align_self": null, "border": null, "bottom": null, "display": null, "flex": null, "flex_flow": null, "grid_area": null, "grid_auto_columns": null, "grid_auto_flow": null, "grid_auto_rows": null, "grid_column": null, "grid_gap": null, "grid_row": null, "grid_template_areas": null, "grid_template_columns": null, "grid_template_rows": null, "height": null, "justify_content": null, "justify_items": null, "left": null, "margin": null, "max_height": null, "max_width": null, "min_height": null, "min_width": null, "object_fit": null, "object_position": null, "order": null, "overflow": null, "overflow_x": null, "overflow_y": null, "padding": null, "right": null, "top": null, "visibility": null, "width": null}}, "548eca9b5c6a483ba3a0e5c0530b13e2": {"model_name": "VBoxModel", "model_module": "@jupyter-widgets/controls", "model_module_version": "1.5.0", "state": {"_dom_classes": ["widget-interact"], "_model_module": "@jupyter-widgets/controls", "_model_module_version": "1.5.0", "_model_name": "VBoxModel", "_view_count": null, "_view_module": "@jupyter-widgets/controls", "_view_module_version": "1.5.0", "_view_name": "VBoxView", "box_style": "", "children": ["IPY_MODEL_515978bf84c04c7abe3ecc2f2f1176e6", "IPY_MODEL_298693efbdb5478694b4a6d785766fbd"], "layout": "IPY_MODEL_02cd22ca8e30474cb6382829faa26295"}}, "23706909252e4782bcbb32db42010563": {"model_name": "LayoutModel", "model_module": "@jupyter-widgets/base", "model_module_version": "1.2.0", "state": {"_model_module": "@jupyter-widgets/base", "_model_module_version": "1.2.0", "_model_name": "LayoutModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "1.2.0", "_view_name": "LayoutView", "align_content": null, "align_items": null, "align_self": null, "border": null, "bottom": null, "display": null, "flex": null, "flex_flow": null, "grid_area": null, "grid_auto_columns": null, "grid_auto_flow": null, "grid_auto_rows": null, "grid_column": null, "grid_gap": null, "grid_row": null, "grid_template_areas": null, "grid_template_columns": null, "grid_template_rows": null, "height": null, "justify_content": null, "justify_items": null, "left": null, "margin": null, "max_height": null, "max_width": null, "min_height": null, "min_width": null, "object_fit": null, "object_position": null, "order": null, "overflow": null, "overflow_x": null, "overflow_y": null, "padding": null, "right": null, "top": null, "visibility": null, "width": null}}, "298693efbdb5478694b4a6d785766fbd": {"model_name": "OutputModel", "model_module": "@jupyter-widgets/output", "model_module_version": "1.0.0", "state": {"_dom_classes": [], "_model_module": "@jupyter-widgets/output", "_model_module_version": "1.0.0", "_model_name": "OutputModel", "_view_count": null, "_view_module": "@jupyter-widgets/output", "_view_module_version": "1.0.0", "_view_name": "OutputView", "layout": "IPY_MODEL_23706909252e4782bcbb32db42010563", "msg_id": "", "outputs": [{"output_type": "display_data", "metadata": {}, "data": {"text/plain": "<IPython.core.display.HTML object>", "text/html": "<img src=\"figures/4/desk_lightsources_example_5.svg\" style=\"max-height:50vh\"/>"}}]}}, "30999bc85a76496e9a81673952b4aff7": {"model_name": "LayoutModel", "model_module": "@jupyter-widgets/base", "model_module_version": "1.2.0", "state": {"_model_module": "@jupyter-widgets/base", "_model_module_version": "1.2.0", "_model_name": "LayoutModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "1.2.0", "_view_name": "LayoutView", "align_content": null, "align_items": null, "align_self": null, "border": null, "bottom": null, "display": null, "flex": null, "flex_flow": null, "grid_area": null, "grid_auto_columns": null, "grid_auto_flow": null, "grid_auto_rows": null, "grid_column": null, "grid_gap": null, "grid_row": null, "grid_template_areas": null, "grid_template_columns": null, "grid_template_rows": null, "height": null, "justify_content": null, "justify_items": null, "left": null, "margin": null, "max_height": null, "max_width": null, "min_height": null, "min_width": null, "object_fit": null, "object_position": null, "order": null, "overflow": null, "overflow_x": null, "overflow_y": null, "padding": null, "right": null, "top": null, "visibility": null, "width": null}}, "86fdcf03cf8b4bea999aff4f1e9720f0": {"model_name": "SliderStyleModel", "model_module": "@jupyter-widgets/controls", "model_module_version": "1.5.0", "state": {"_model_module": "@jupyter-widgets/controls", "_model_module_version": "1.5.0", "_model_name": "SliderStyleModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "1.2.0", "_view_name": "StyleView", "description_width": "", "handle_color": null}}, "176f111024f24c799873b4c3e265fda0": {"model_name": "IntSliderModel", "model_module": "@jupyter-widgets/controls", "model_module_version": "1.5.0", "state": {"_dom_classes": [], "_model_module": "@jupyter-widgets/controls", "_model_module_version": "1.5.0", "_model_name": "IntSliderModel", "_view_count": null, "_view_module": "@jupyter-widgets/controls", "_view_module_version": "1.5.0", "_view_name": "IntSliderView", "continuous_update": true, "description": "i", "description_tooltip": null, "disabled": false, "layout": "IPY_MODEL_30999bc85a76496e9a81673952b4aff7", "max": 7, "min": 1, "orientation": "horizontal", "readout": true, "readout_format": "d", "step": 1, "style": "IPY_MODEL_86fdcf03cf8b4bea999aff4f1e9720f0", "value": 7}}, "1b66bf02a65e4ca99c3c2daa229d36b2": {"model_name": "LayoutModel", "model_module": "@jupyter-widgets/base", "model_module_version": "1.2.0", "state": {"_model_module": "@jupyter-widgets/base", "_model_module_version": "1.2.0", "_model_name": "LayoutModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "1.2.0", "_view_name": "LayoutView", "align_content": null, "align_items": null, "align_self": null, "border": null, "bottom": null, "display": null, "flex": null, "flex_flow": null, "grid_area": null, "grid_auto_columns": null, "grid_auto_flow": null, "grid_auto_rows": null, "grid_column": null, "grid_gap": null, "grid_row": null, "grid_template_areas": null, "grid_template_columns": null, "grid_template_rows": null, "height": null, "justify_content": null, "justify_items": null, "left": null, "margin": null, "max_height": null, "max_width": null, "min_height": null, "min_width": null, "object_fit": null, "object_position": null, "order": null, "overflow": null, "overflow_x": null, "overflow_y": null, "padding": null, "right": null, "top": null, "visibility": null, "width": null}}, "8c185786758944ec9da33ba38e7eaeaf": {"model_name": "VBoxModel", "model_module": "@jupyter-widgets/controls", "model_module_version": "1.5.0", "state": {"_dom_classes": ["widget-interact"], "_model_module": "@jupyter-widgets/controls", "_model_module_version": "1.5.0", "_model_name": "VBoxModel", "_view_count": null, "_view_module": "@jupyter-widgets/controls", "_view_module_version": "1.5.0", "_view_name": "VBoxView", "box_style": "", "children": ["IPY_MODEL_176f111024f24c799873b4c3e265fda0", "IPY_MODEL_3245345a961a40f78f78f41a5abae9d1"], "layout": "IPY_MODEL_1b66bf02a65e4ca99c3c2daa229d36b2"}}, "902692b58d04478bb41d07f342f16322": {"model_name": "LayoutModel", "model_module": "@jupyter-widgets/base", "model_module_version": "1.2.0", "state": {"_model_module": "@jupyter-widgets/base", "_model_module_version": "1.2.0", "_model_name": "LayoutModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "1.2.0", "_view_name": "LayoutView", "align_content": null, "align_items": null, "align_self": null, "border": null, "bottom": null, "display": null, "flex": null, "flex_flow": null, "grid_area": null, "grid_auto_columns": null, "grid_auto_flow": null, "grid_auto_rows": null, "grid_column": null, "grid_gap": null, "grid_row": null, "grid_template_areas": null, "grid_template_columns": null, "grid_template_rows": null, "height": null, "justify_content": null, "justify_items": null, "left": null, "margin": null, "max_height": null, "max_width": null, "min_height": null, "min_width": null, "object_fit": null, "object_position": null, "order": null, "overflow": null, "overflow_x": null, "overflow_y": null, "padding": null, "right": null, "top": null, "visibility": null, "width": null}}, "3245345a961a40f78f78f41a5abae9d1": {"model_name": "OutputModel", "model_module": "@jupyter-widgets/output", "model_module_version": "1.0.0", "state": {"_dom_classes": [], "_model_module": "@jupyter-widgets/output", "_model_module_version": "1.0.0", "_model_name": "OutputModel", "_view_count": null, "_view_module": "@jupyter-widgets/output", "_view_module_version": "1.0.0", "_view_name": "OutputView", "layout": "IPY_MODEL_902692b58d04478bb41d07f342f16322", "msg_id": "", "outputs": [{"output_type": "display_data", "metadata": {}, "data": {"text/plain": "<IPython.core.display.HTML object>", "text/html": "<img src=\"figures/4/symmetric_transport_matrix_7.svg\" style=\"max-height:50vh\"/>"}}]}}}, "version_major": 2, "version_minor": 0}
</script>


    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "compimg"
        },
        kernelOptions: {
            kernelName: "compimg",
            path: "./."
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'compimg'</script>

              </div>
              
            </main>
            <footer class="footer-article noprint">
                
    <!-- Previous / next buttons -->
<div class='prev-next-area'>
    <a class='left-prev' id="prev-link" href="03_LightFieldMethods.html" title="previous page">
        <i class="fas fa-angle-left"></i>
        <div class="prev-next-info">
            <p class="prev-next-subtitle">previous</p>
            <p class="prev-next-title">Light Field Methods</p>
        </div>
    </a>
    <a class='right-next' id="next-link" href="05_NeuralNetworksForCompImg.html" title="next page">
    <div class="prev-next-info">
        <p class="prev-next-subtitle">next</p>
        <p class="prev-next-title">Neural Networks for Computational Imaging</p>
    </div>
    <i class="fas fa-angle-right"></i>
    </a>
</div>
            </footer>
        </div>
    </div>
    <div class="footer-content row">
        <footer class="col footer"><p>
  
    By Dr.-Ing. Johannes Meyer<br/>
  
      &copy; Copyright 2022.<br/>
</p>
        </footer>
    </div>
    
</div>


      </div>
    </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script src="_static/scripts/pydata-sphinx-theme.js?digest=1999514e3f237ded88cf"></script>


  </body>
</html>